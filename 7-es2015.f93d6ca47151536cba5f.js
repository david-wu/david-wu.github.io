(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"648H":function(e,t,n){"use strict";var o=n("8Y7J"),c=n("nPNc"),r=n("6TI7"),s=n("+J3Q"),i=n("LvDl"),a=n("5tJd");class l{constructor(){this.filterStr="",this.selectedResourceIdChange=new o.m,this.selectedResourceIdsChange=new o.m,this.resourceIds=new Set,this.fileGroup=a.a.createWithRoot("ROOT"),this.rootFileId="ROOT"}ngOnChanges(e){e.resources&&this.onResourcesChanges(this.resources),e.selectedResourceId&&!this.selectedResourceIds&&(this.resourceIds=this.selectedResourceId?new Set([this.selectedResourceId]):new Set),e.selectedResourceIds&&this.selectedResourceIds&&(this.resourceIds=new Set(this.selectedResourceIds))}onResourcesChanges(e){const t=Object(i.map)(e,e=>({id:e.id,label:e.label||e.id}));this.fileGroup.setRootChildren(t)}onSelectedFileIdsChange(e){this.isMultiSelect&&this.selectedResourceIdsChange.emit(e);const t=Array.from(e||[])[0];this.selectedResourceIdChange.emit(t)}}var u=o.qb({encapsulation:0,styles:[["[_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   dwu-file-explorer[_ngcontent-%COMP%]{display:flex;height:100%;width:100%}"]],data:{}});function d(e){return o.Nb(0,[(e()(),o.sb(0,0,null,null,2,"dwu-file-explorer",[],null,[[null,"filesByIdChange"],[null,"closedFileIdsChange"],[null,"selectedFileIdsChange"]],(function(e,t,n){var o=!0,c=e.component;return"filesByIdChange"===t&&(o=!1!==(c.fileGroup.filesById=n)&&o),"closedFileIdsChange"===t&&(o=!1!==c.fileGroup.setClosedFileIds(n)&&o),"selectedFileIdsChange"===t&&(o=!1!==c.onSelectedFileIdsChange(n)&&o),o}),c.b,c.a)),o.Ib(512,null,r.c,r.c,[[2,r.d]]),o.rb(2,4898816,null,0,s.a,[r.c,o.k],{rootFileId:[0,"rootFileId"],fuzzFilterString:[1,"fuzzFilterString"],filesById:[2,"filesById"],closedFileIds:[3,"closedFileIds"],selectedFileIds:[4,"selectedFileIds"],perfMode:[5,"perfMode"],multiFileSelect:[6,"multiFileSelect"]},{filesByIdChange:"filesByIdChange",closedFileIdsChange:"closedFileIdsChange",selectedFileIdsChange:"selectedFileIdsChange"})],(function(e,t){var n=t.component;e(t,2,0,n.fileGroup.rootFileId,n.filterStr,n.fileGroup.filesById,n.fileGroup.closedFileIds,n.resourceIds,!0,n.isMultiSelect)}),null)}var g=n("SVse");n("Jtcz"),n("DQLy"),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return O}));var b=o.qb({encapsulation:0,styles:[["[_nghost-%COMP%]{height:100%;width:100%}"]],data:{}});function O(e){return o.Nb(0,[(e()(),o.sb(0,0,null,null,2,"dwu-resource-selector",[["class","file-explorer"]],null,[[null,"selectedResourceIdChange"],[null,"selectedResourceIdsChange"]],(function(e,t,n){var o=!0,c=e.component;return"selectedResourceIdChange"===t&&(o=!1!==c.onSelectedImageSourceIdChange(n)&&o),"selectedResourceIdsChange"===t&&(o=!1!==c.onSelectedResourceIdsChange(n)&&o),o}),d,u)),o.rb(1,573440,null,0,l,[],{resources:[0,"resources"],filterStr:[1,"filterStr"],selectedResourceId:[2,"selectedResourceId"],isMultiSelect:[3,"isMultiSelect"],selectedResourceIds:[4,"selectedResourceIds"]},{selectedResourceIdChange:"selectedResourceIdChange",selectedResourceIdsChange:"selectedResourceIdsChange"}),o.Fb(131072,g.b,[o.h])],(function(e,t){var n=t.component;e(t,1,0,o.Mb(t,1,0,o.Db(t,2).transform(n.resourceList$)),n.filterStr,n.selectedResourceId,n.isMultiSelect,n.selectedResourceIds)}),null)}},"8oDX":function(e,t,n){"use strict";n.r(t);var o=n("8Y7J");class c{}var r=n("Vxrp"),s=n("pMnS"),i=n("l0ih"),a=n("iUGO"),l=n("DQLy"),u=n("iInd"),d=n("6+7j"),g=n("sjqh"),b=n("648H"),O=n("Jtcz"),h=n("SVse"),p=n("YZbJ"),C=n("ssbT");class f{constructor(e,t,n){this.store=e,this.router=t,this.activatedRoute=n,this.filterStr="",this.leftSideExpanded=!1,this.imageSourcesConfig={path:"imageSources"},this.user$=this.store.pipe(Object(l.B)(p.d)),this.selectedImageSourceId$=this.store.pipe(Object(l.B)(C.f)),this.loadInUrlState(this.router.url),this.sub=this.router.events.subscribe(e=>{e instanceof u.d&&this.loadInUrlState(e.url)})}onSelectedImageSourceIdChange(e){const t=this.router.createUrlTree([e],{relativeTo:this.activatedRoute});this.store.dispatch(C.a.navigateToImageSourceView({payload:t.toString()}))}loadInUrlState(e){const t=e.split("/"),n=t.indexOf("image-sources"),o=n+1,c=t[n+2];this.store.dispatch(C.a.setSelectedImageSourceId({payload:"intro"===t[o]?void 0:t[o]})),this.store.dispatch(C.a.setImageSourceViewTab({payload:c}))}}var m=o.qb({encapsulation:0,styles:[["[_nghost-%COMP%]{display:block;height:100%;width:100%}@media screen and (max-width:750px){[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]{flex-direction:column}[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]{box-shadow:2px 2px 4px 0 #9d9b99;flex:0 0 auto;height:13.25rem;width:100%;max-width:none;transition:height 50ms}[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side.expanded[_ngcontent-%COMP%]{height:75%}[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]{background-color:#3f4038;color:#fcfcf9;position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:3.5rem;height:1rem;border:1px solid #8a9a5b;border-radius:5px 5px 0 0;text-align:center;display:flex;justify-content:center;cursor:pointer}[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#4b5320;color:#fcfcf9}[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander.active[_ngcontent-%COMP%]:not([disabled]){background-color:#708238;color:#fcfcf9}[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.3}[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]   .expander-icon[_ngcontent-%COMP%]{font-size:16px}[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]   .expander-icon.flipped[_ngcontent-%COMP%]{transform:rotate(180deg)}}.narrow-mode[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]{flex-direction:column}.narrow-mode[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]{box-shadow:2px 2px 4px 0 #9d9b99;flex:0 0 auto;height:13.25rem;width:100%;max-width:none;transition:height 50ms}.narrow-mode[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side.expanded[_ngcontent-%COMP%]{height:75%}.narrow-mode[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]{background-color:#3f4038;color:#fcfcf9;position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:3.5rem;height:1rem;border:1px solid #8a9a5b;border-radius:5px 5px 0 0;text-align:center;display:flex;justify-content:center;cursor:pointer}.narrow-mode[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#4b5320;color:#fcfcf9}.narrow-mode[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander.active[_ngcontent-%COMP%]:not([disabled]){background-color:#708238;color:#fcfcf9}.narrow-mode[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.3}.narrow-mode[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]   .expander-icon[_ngcontent-%COMP%]{font-size:16px}.narrow-mode[_nghost-%COMP%]   div.page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]   .expander-icon.flipped[_ngcontent-%COMP%]{transform:rotate(180deg)}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]{height:100%;width:100%;display:flex}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]{position:relative;flex:1 1 0;overflow:hidden;max-width:27.5%;min-width:20rem}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]   .left-side[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]   .right-side[_ngcontent-%COMP%]{flex:1 1 0;overflow:auto;position:relative}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]{background-color:#ddd9cf;display:flex;flex-direction:column}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .explorer-title[_ngcontent-%COMP%]{text-align:center;font-size:1.25rem;padding-top:.5rem}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]{flex:0 0 auto;display:flex;align-items:center}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .wide-button-container[_ngcontent-%COMP%]{flex:1 1 0}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .control-button[_ngcontent-%COMP%]{background-color:#eae6da;min-width:2rem;padding:.25rem .5rem;font-size:1rem;cursor:pointer;text-align:center;outline:0;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:none}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .control-button[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#bac39f}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .control-button.active[_ngcontent-%COMP%]:not([disabled]){background-color:#708238;color:#fcfcf9}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .control-button[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.3}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .wide-button[_ngcontent-%COMP%]{flex:1 1 0;background-color:#eae6da;min-width:2rem;padding:.25rem .5rem;font-size:1rem;cursor:pointer;text-align:center;outline:0;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:none}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .wide-button[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#bac39f}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .wide-button.active[_ngcontent-%COMP%]:not([disabled]){background-color:#708238;color:#fcfcf9}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .wide-button[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.3}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]{flex:0 0 auto;background-color:#eae6da;min-width:2rem;padding:.25rem .5rem;font-size:1rem;cursor:pointer;text-align:center;outline:0;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:none;height:26px;display:flex;align-items:center}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#bac39f}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .icon-button.active[_ngcontent-%COMP%]:not([disabled]){background-color:#708238;color:#fcfcf9}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .icon-button[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.3}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .control-buttons[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:1rem}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .file-explorer[_ngcontent-%COMP%]{flex:1 1 0}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .view-tab[_ngcontent-%COMP%]{background-color:#eae6da;min-width:2rem;padding:.25rem 1rem;font-size:1rem;cursor:pointer;text-align:center;outline:0;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:none}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .view-tab[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#bac39f}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .view-tab.active[_ngcontent-%COMP%]:not([disabled]){background-color:#708238;color:#fcfcf9}[_nghost-%COMP%]   .left-side[_ngcontent-%COMP%]   .view-tab[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.3}"]],data:{}});function _(e){return o.Nb(0,[(e()(),o.sb(0,0,null,null,21,"div",[["class","page-container"]],null,null,null,null,null)),(e()(),o.sb(1,0,null,null,17,"div",[["class","left-side"]],[[2,"expanded",null]],null,null,null,null)),(e()(),o.sb(2,0,null,null,11,"div",[["class","control-buttons"]],null,null,null,null,null)),(e()(),o.sb(3,0,null,null,1,"dwu-resource-create-button",[["class","wide-button-container"]],null,null,null,i.b,i.a)),o.rb(4,49152,null,0,a.a,[l.n],{resourceConfig:[0,"resourceConfig"],buttonLabel:[1,"buttonLabel"]},null),(e()(),o.sb(5,0,null,null,8,"div",[["class","icon-button"]],null,[[null,"click"]],(function(e,t,n){var c=!0;return"click"===t&&(c=!1!==o.Db(e,6).onClick()&&c),c}),null,null)),o.rb(6,16384,[[1,4]],0,u.m,[u.l,u.a,[8,null],o.C,o.k],{routerLink:[0,"routerLink"]},null),o.Eb(7,1),o.rb(8,1720320,null,2,u.n,[u.l,o.k,o.C,[2,u.m],[2,u.o]],{routerLinkActive:[0,"routerLinkActive"]},null),o.Jb(603979776,1,{links:1}),o.Jb(603979776,2,{linksWithHrefs:1}),o.Eb(11,1),(e()(),o.sb(12,0,null,null,1,"span",[["class","material-icons"]],null,null,null,null,null)),(e()(),o.Lb(-1,null,["help"])),(e()(),o.sb(14,0,null,null,1,"dwu-search-input",[],null,[[null,"searchTextChange"]],(function(e,t,n){var o=!0;return"searchTextChange"===t&&(o=!1!==(e.component.filterStr=n)&&o),o}),d.b,d.a)),o.rb(15,49152,null,0,g.a,[],{searchText:[0,"searchText"],placeholder:[1,"placeholder"]},{searchTextChange:"searchTextChange"}),(e()(),o.sb(16,0,null,null,2,"dwu-resource-list-view",[],null,[[null,"selectedResourceIdChange"]],(function(e,t,n){var o=!0;return"selectedResourceIdChange"===t&&(o=!1!==e.component.onSelectedImageSourceIdChange(n)&&o),o}),b.b,b.a)),o.rb(17,704512,null,0,O.a,[l.n],{resourceConfig:[0,"resourceConfig"],filterStr:[1,"filterStr"],selectedResourceId:[2,"selectedResourceId"]},{selectedResourceIdChange:"selectedResourceIdChange"}),o.Fb(131072,h.b,[o.h]),(e()(),o.sb(19,0,null,null,2,"div",[["class","right-side"]],null,null,null,null,null)),(e()(),o.sb(20,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),o.rb(21,212992,null,0,u.q,[u.b,o.O,o.j,[8,null],o.h],null,null)],(function(e,t){var n=t.component;e(t,4,0,n.imageSourcesConfig,"+ New Source");var c=e(t,7,0,"intro");e(t,6,0,c);var r=e(t,11,0,"active");e(t,8,0,r),e(t,15,0,n.filterStr,"search.."),e(t,17,0,n.imageSourcesConfig,n.filterStr,o.Mb(t,17,2,o.Db(t,18).transform(n.selectedImageSourceId$))),e(t,21,0)}),(function(e,t){e(t,1,0,t.component.leftSideExpanded)}))}function S(e){return o.Nb(0,[(e()(),o.Lb(-1,null,[" login\n"]))],null,null)}function I(e){return o.Nb(0,[(e()(),o.hb(16777216,null,null,2,null,_)),o.rb(1,16384,null,0,h.m,[o.O,o.L],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),o.Fb(131072,h.b,[o.h]),(e()(),o.hb(0,[["loginTemplate",2]],null,0,null,S))],(function(e,t){var n=t.component;e(t,1,0,o.Mb(t,1,0,o.Db(t,2).transform(n.user$)),o.Db(t,3))}),null)}function M(e){return o.Nb(0,[(e()(),o.sb(0,0,null,null,1,"dwu-image-sources",[],null,null,null,I,m)),o.rb(1,49152,null,0,f,[l.n,u.l,u.a],null,null)],null,null)}var P=o.ob("dwu-image-sources",f,M,{},{},[]),j=n("PTyj"),v=n("s7LF"),R=n("0gVX"),y=n("trGy"),E=n("Z2Br"),T=n("xpxz"),w=n("mrSG"),A=n("HDdC"),x=n("lJxs");class k{constructor(e,t,n,o,c){this.firebaseFunctionsService=e,this.firestore=t,this.storage=n,this.imageProcessing=o,this.exifService=c}generateImageSourceToken(e){return w.a(this,void 0,void 0,(function*(){const t=this.firebaseFunctionsService.functions.httpsCallable("generateImageSourceTokenTask");return yield t({imageSourceId:e})}))}deleteFile(e){return w.a(this,void 0,void 0,(function*(){return yield this.storage.deleteFile(e),yield this.firestore.unregisterFile(e)}))}uploadImageSourceFile(e,t,n){return w.a(this,void 0,void 0,(function*(){const o=yield this.exifService.getExifData(e),c=this.exifService.getLocationData(o),r={userId:t.uid,fileName:e.name,isUploaded:!1,sourceId:n,locationData:Object.assign({},c)},s=yield this.firestore.insertUploadDoc(r),i=Object.assign({},r,{id:s.id}),a=yield this.imageProcessing.processImageFile(e,o),l=yield this.storage.uploadFile(a,i.id),u={downloadUrl:yield l.ref.getDownloadURL()};return yield this.firestore.registerFileUploaded(i.id,u)}))}updateImageSource(e,t){return this.firestore.db.collection("imageSources").doc(e).update(t)}loadImageSourceTokens(e){return A.a.create(t=>this.firestore.db.collection("imageSources").doc(e).collection("accessTokens").orderBy("createdAt","desc").onSnapshot(t)).pipe(Object(x.a)(e=>e.docs.map(e=>Object.assign({},e.data(),{id:e.id}))))}}var B=n("QmNs"),F=n("GrFz"),G=n("cxyc"),U=n("YDhq"),L=n("T2NM"),D=n("7bNT"),z=n("5a0h"),Y=n("ntSj"),N=n("O0RR"),V=n("FE7n"),$=n("Rkte"),J=n("mRcA"),Q=n("R7F0"),q=n("a6Df"),W=n("6TI7"),K=n("IP0z"),H=n("/HVE"),X=n("hOhj"),Z=n("FdjG"),ee=n("mzR0"),te=n("Wu5v"),ne=n("R3e+");const oe=()=>n.e(29).then(n.bind(null,"YykA")).then(e=>e.ImageSourcesIntroModuleNgFactory),ce=()=>n.e(38).then(n.bind(null,"9Vr9")).then(e=>e.ImageSourceViewModuleNgFactory);class re{}var se=n("3A+F"),ie=n("jG/M"),ae=n("Ql0z"),le=n("W61y");n.d(t,"ImageSourcesModuleNgFactory",(function(){return ue}));var ue=o.pb(c,[],(function(e){return o.Ab([o.Bb(512,o.j,o.ab,[[8,[r.a,s.a,P,j.b]],[3,o.j],o.v]),o.Bb(4608,h.o,h.n,[o.s,[2,h.A]]),o.Bb(4608,v.r,v.r,[]),o.Bb(135680,R.a,R.a,[o.j,o.g,o.p]),o.Bb(4608,y.a,y.a,[E.a]),o.Bb(4608,T.a,T.a,[E.a]),o.Bb(4608,k,k,[B.a,T.a,F.a,G.a,U.a]),o.Bb(4608,L.a,L.a,[l.n,D.a,T.a,k,u.l,z.a]),o.Bb(1073742336,h.c,h.c,[]),o.Bb(1073742336,v.q,v.q,[]),o.Bb(1073742336,v.h,v.h,[]),o.Bb(1073742336,Y.a,Y.a,[]),o.Bb(1073742336,N.a,N.a,[]),o.Bb(1073742336,V.a,V.a,[]),o.Bb(1073742336,$.a,$.a,[]),o.Bb(1073742336,J.a,J.a,[]),o.Bb(1073742336,Q.a,Q.a,[]),o.Bb(1073742336,q.a,q.a,[]),o.Bb(1073742336,W.b,W.b,[]),o.Bb(1073742336,K.a,K.a,[]),o.Bb(1073742336,H.b,H.b,[]),o.Bb(1073742336,X.h,X.h,[]),o.Bb(1073742336,Z.a,Z.a,[]),o.Bb(1073742336,ee.a,ee.a,[]),o.Bb(1073742336,te.a,te.a,[]),o.Bb(1073742336,ne.a,ne.a,[]),o.Bb(1073742336,u.p,u.p,[[2,u.u],[2,u.l]]),o.Bb(1073742336,re,re,[]),o.Bb(1073742336,se.a,se.a,[]),o.Bb(1073742336,ie.a,ie.a,[]),o.Bb(1024,l.O,(function(){return[{}]}),[]),o.Bb(1024,l.j,(function(){return[{key:"imageSources",reducerFactory:l.s,metaReducers:[],initialState:void 0}]}),[]),o.Bb(1024,l.P,l.W,[o.p,l.O,l.j]),o.Bb(1024,l.N,(function(){return[ae.a]}),[]),o.Bb(1024,l.Q,(function(e){return[e]}),[l.N]),o.Bb(1024,l.b,(function(e,t,n){return[l.X(e,t,n)]}),[o.p,l.N,l.Q]),o.Bb(1024,l.U,(function(e){return[l.H(e)]}),[l.T]),o.Bb(1073873408,l.o,l.o,[l.P,l.b,l.g,l.p,[2,l.U]]),o.Bb(1024,D.p,(function(){return[[L.a]]}),[]),o.Bb(1024,D.g,(function(){return[[]]}),[]),o.Bb(1024,D.q,(function(e,t,n){return[D.k(e,t,n)]}),[o.p,D.p,D.g]),o.Bb(1073742336,D.d,D.d,[D.e,D.q,[2,l.p],[2,l.o]]),o.Bb(1073742336,c,c,[]),o.Bb(1024,u.j,(function(){return[[{path:"",component:f,children:[{path:"intro",loadChildren:oe},{path:":imageSourceId",loadChildren:ce},{path:"",pathMatch:"full",redirectTo:"intro"}]}],[{path:"auth",component:le.a},{path:"auth-success",component:le.a}]]}),[])])}))},Jtcz:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n("8Y7J"),c=n("2Vo4"),r=n("eIep"),s=n("lJxs"),i=n("DQLy"),a=n("RrDs");class l{constructor(e){this.store=e,this.filterStr="",this.selectedResourceIdChange=new o.m,this.selectedResourceIdsChange=new o.m,this.resourceConfig$=new c.a(void 0),this.resourceList$=this.resourceConfig$.pipe(Object(r.a)(e=>this.store.pipe(Object(i.B)(a.b),Object(s.a)(t=>t&&t[e.path]))))}ngOnChanges(e){if(e.resourceConfig){this.resourceConfig$.next(this.resourceConfig);const{currentValue:t,previousValue:n}=e.resourceConfig;t&&this.store.dispatch(a.a.addVisibleResourceList({resource:t})),n&&this.store.dispatch(a.a.removeVisibleResourceList({resource:n}))}}ngOnDestroy(){this.resourceConfig&&this.store.dispatch(a.a.removeVisibleResourceList({resource:this.resourceConfig}))}onSelectedImageSourceIdChange(e){this.selectedResourceIdChange.emit(e)}onSelectedResourceIdsChange(e){this.selectedResourceIdsChange.emit(e)}}},Ql0z:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n("DQLy"),c=n("YMmn"),r=n("YDRF");const s=Object(o.w)(r.a,Object(o.z)(c.a.setSelectedImageSourceId,(e,t)=>Object.assign({},e,{selectedImageSourceId:t.payload})),Object(o.z)(c.a.addImagesBySourceId,(e,t)=>Object.assign({},e,{imagesBySourceId:Object.assign({},e,t.payload)})),Object(o.z)(c.a.setImageSourceViewTab,(e,t)=>Object.assign({},e,{imageSourceViewTab:t.payload})),Object(o.z)(c.a.generateImageSourceToken,(e,t)=>Object.assign({},e,{isGeneratingTokenByImageSource:Object.assign({},e.isGeneratingTokenByImageSource,{[t.payload]:!0})})),Object(o.z)(c.a.generateImageSourceTokenSuccess,(e,t)=>Object.assign({},e,{isGeneratingTokenByImageSource:Object.assign({},e.isGeneratingTokenByImageSource,{[t.payload]:!1})})),Object(o.z)(c.a.generateImageSourceTokenFailure,(e,t)=>Object.assign({},e,{isGeneratingTokenByImageSource:Object.assign({},e.isGeneratingTokenByImageSource,{[t.payload]:!1})})),Object(o.z)(c.a.loadImageSourceTokensSuccess,(e,t)=>Object.assign({},e,{imageSourceTokensByImageSource:Object.assign({},e.imageSourceTokensByImageSource,{[t.imageSourceId]:t.imageSourceTokens})})));function i(e,t){return s(e,t)}},"R3e+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));class o{}},RrDs:function(e,t,n){"use strict";var o=n("yLDM");n.d(t,"a",(function(){return o.a})),n("dW0t"),n("dYoV");var c=n("rUW/");n.d(t,"b",(function(){return c.a})),n("iKuT")},T2NM:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var o=n("7bNT"),c=n("DQLy"),r=n("LRne"),s=n("Cfvw"),i=n("zp1y"),a=n("eIep"),l=n("lJxs"),u=n("JIr8"),d=n("YMmn"),g=n("nAcS"),b=n("YZbJ");class O{constructor(e,t,n,O,h,p){this.store$=e,this.actions$=t,this.firestore=n,this.imageSourcesService=O,this.router=h,this.ppService=p,this.loadImagesBySourceId$=Object(o.h)(()=>this.actions$.pipe(Object(o.j)(d.a.loadImagesBySourceId),Object(i.a)(this.store$.pipe(Object(c.B)(b.d))),Object(a.a)(([e,t])=>{const n=e.payload;return n&&t?this.ppService.getFilesForSource$(n).pipe(Object(l.a)(e=>d.a.addImagesBySourceId({payload:{[n]:e}}))):Object(r.a)(d.a.addImagesBySourceId({payload:{}}))}))),this.uploadImageSourceFile$=Object(o.h)(()=>this.actions$.pipe(Object(o.j)(d.a.uploadImageSourceFile),Object(i.a)(this.store$.pipe(Object(c.B)(b.d))),Object(a.a)(([e,t])=>{const n=e.selectedImageSourceId,o=e.file;console.log(o);const c=function(e,t=2097152){const n=[];for(;n.length*t<e.size;){const o=n.length*t,c=Math.min(o+t,e.size);n.push(e.slice(o,c))}return n}(o).reduce((e,t)=>e+t.size,0);return console.log("sum",c,o.size),n&&t?Object(s.a)(this.imageSourcesService.uploadImageSourceFile(o,t,n)).pipe(Object(l.a)(e=>(console.log("uploadedImage",e),d.a.uploadImageSourceFileSuccess({selectedImageSourceId:n})))):Object(r.a)(d.a.uploadImageSourceFileFailure({payload:"no user or source"}))}))),this.deleteUpload$=Object(o.h)(()=>this.actions$.pipe(Object(o.j)(d.a.deleteUpload),Object(a.a)(e=>{const t=e.payload;return t?Object(s.a)(this.imageSourcesService.deleteFile(t)).pipe(Object(l.a)(e=>d.a.deleteUploadSuccess({payload:t}))):Object(r.a)(d.a.deleteUploadFailure({payload:"no uploadId"}))}))),this.navigateToImageSourceView$=Object(o.h)(()=>this.actions$.pipe(Object(o.j)(d.a.navigateToImageSourceView),Object(i.a)(this.store$.pipe(Object(c.B)(g.b))),Object(l.a)(([e,t])=>this.router.navigate([e.payload,...t?[t]:[]]))),{dispatch:!1}),this.updateImageSource$=Object(o.h)(()=>this.actions$.pipe(Object(o.j)(d.a.updateImageSource),Object(a.a)(e=>{const{imageSourceId:t,patch:n}=e;return Object(s.a)(this.imageSourcesService.updateImageSource(t,n)).pipe(Object(l.a)(e=>d.a.updateImageSourceSuccess({imageSourceId:t,patch:n})))}))),this.generateImageSourceToken$=Object(o.h)(()=>this.actions$.pipe(Object(o.j)(d.a.generateImageSourceToken),Object(a.a)(e=>{const t=e.payload;return Object(s.a)(this.imageSourcesService.generateImageSourceToken(t)).pipe(Object(l.a)(()=>d.a.generateImageSourceTokenSuccess({payload:t})),Object(u.a)(()=>Object(r.a)(d.a.generateImageSourceTokenFailure({payload:t}))))}))),this.loadImageSourceTokens$=Object(o.h)(()=>this.actions$.pipe(Object(o.j)(d.a.loadImageSourceTokens),Object(a.a)(e=>{const t=e.imageSourceId;return Object(s.a)(this.imageSourcesService.loadImageSourceTokens(t)).pipe(Object(l.a)(e=>d.a.loadImageSourceTokensSuccess({imageSourceId:t,imageSourceTokens:e})))})))}}},Wu5v:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));class o{}},YDRF:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o={imageSourcesListVisible:!1,imageSourcesList:[],selectedImageSourceId:void 0,imagesBySourceId:{},imageSourceViewTab:void 0,isGeneratingTokenByImageSource:{},imageSourceTokensByImageSource:{}}},YMmn:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("DQLy");let c=(()=>{class e{}return e.CATEGORY="[IMAGE_SOURCES]",e.setSelectedImageSourceId=Object(o.u)(e.CATEGORY+" SET_SELECTED_IMAGE_SOURCE_ID",Object(o.A)()),e.loadImagesBySourceId=Object(o.u)(e.CATEGORY+" LOAD_IMAGES_BY_SOURCE_ID",Object(o.A)()),e.addImagesBySourceId=Object(o.u)(e.CATEGORY+" ADD_IMAGES_BY_SOURCE_ID",Object(o.A)()),e.uploadImageSourceFile=Object(o.u)(e.CATEGORY+" UPLOAD_IMAGE_SOURCE_FILE",Object(o.A)()),e.uploadImageSourceFileSuccess=Object(o.u)(e.CATEGORY+" UPLOAD_IMAGE_SOURCE_FILE_SUCCESS",Object(o.A)()),e.uploadImageSourceFileFailure=Object(o.u)(e.CATEGORY+" UPLOAD_IMAGE_SOURCE_FILE_FAILURE",Object(o.A)()),e.deleteUpload=Object(o.u)(e.CATEGORY+" DELETE_UPLOAD",Object(o.A)()),e.deleteUploadSuccess=Object(o.u)(e.CATEGORY+" DELETE_UPLOAD_SUCCESS",Object(o.A)()),e.deleteUploadFailure=Object(o.u)(e.CATEGORY+" DELETE_UPLOAD_FAILURE",Object(o.A)()),e.setImageSourceViewTab=Object(o.u)(e.CATEGORY+" SET_IMAGE_SOURCE_VIEW_TAB",Object(o.A)()),e.navigateToImageSourceView=Object(o.u)(e.CATEGORY+" NAVIGATE_TO_IMAGE_SOURCE_VIEW",Object(o.A)()),e.updateImageSource=Object(o.u)(e.CATEGORY+" UPDATE_IMAGE_SOURCE",Object(o.A)()),e.updateImageSourceSuccess=Object(o.u)(e.CATEGORY+" UPDATE_IMAGE_SOURCE_SUCCESS",Object(o.A)()),e.updateImageSourceFailure=Object(o.u)(e.CATEGORY+" UPDATE_IMAGE_SOURCE_FAILURE",Object(o.A)()),e.generateImageSourceToken=Object(o.u)(e.CATEGORY+" GENERATE_IMAGE_SOURCE_TOKEN",Object(o.A)()),e.generateImageSourceTokenSuccess=Object(o.u)(e.CATEGORY+" GENERATE_IMAGE_SOURCE_TOKEN_SUCCESS",Object(o.A)()),e.generateImageSourceTokenFailure=Object(o.u)(e.CATEGORY+" GENERATE_IMAGE_SOURCE_TOKEN_FAILURE",Object(o.A)()),e.loadImageSourceTokens=Object(o.u)(e.CATEGORY+" LOAD_IMAGE_SOURCE_TOKENS",Object(o.A)()),e.loadImageSourceTokensSuccess=Object(o.u)(e.CATEGORY+" LOAD_IMAGE_SOURCE_TOKENS_SUCCESS",Object(o.A)()),e.loadImageSourceTokensFailure=Object(o.u)(e.CATEGORY+" LOAD_IMAGE_SOURCE_TOKENS_FAILURE",Object(o.A)()),e})()},iUGO:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n("RrDs");class c{constructor(e){this.store=e,this.buttonLabel="++"}onCreateResource(){this.store.dispatch(o.a.createResourceDoc({resource:this.resourceConfig,patch:{}}))}}},l0ih:function(e,t,n){"use strict";var o=n("8Y7J");n("iUGO"),n("DQLy"),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return r}));var c=o.qb({encapsulation:0,styles:[["[_nghost-%COMP%]{height:100%;width:100%}[_nghost-%COMP%]   .wide-button[_ngcontent-%COMP%]{background-color:#eae6da;min-width:2rem;padding:.25rem .5rem;font-size:1rem;cursor:pointer;text-align:center;outline:0;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:none}[_nghost-%COMP%]   .wide-button[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#bac39f}[_nghost-%COMP%]   .wide-button.active[_ngcontent-%COMP%]:not([disabled]){background-color:#708238;color:#fcfcf9}[_nghost-%COMP%]   .wide-button[disabled][_ngcontent-%COMP%]{pointer-events:none;opacity:.3}"]],data:{}});function r(e){return o.Nb(0,[(e()(),o.sb(0,0,null,null,1,"div",[["class","wide-button"]],null,[[null,"click"]],(function(e,t,n){var o=!0;return"click"===t&&(o=!1!==e.component.onCreateResource()&&o),o}),null,null)),(e()(),o.Lb(1,null,[" ","\n"]))],null,(function(e,t){e(t,1,0,t.component.buttonLabel)}))}},mzR0:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));class o{}},nAcS:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return O}));var o=n("DQLy"),c=n("LvDl"),r=n("RrDs");const s=Object(o.v)("imageSources"),i=(Object(o.y)(s,e=>e.imageSourcesListVisible),Object(o.y)(r.b,e=>Object(c.keyBy)(e.imageSources,"id"))),a=Object(o.y)(s,e=>e.selectedImageSourceId),l=Object(o.y)(i,a,(e,t)=>e[t]),u=Object(o.y)(s,e=>e.imagesBySourceId),d=Object(o.y)(s,e=>e.imageSourceViewTab),g=Object(o.y)(s,e=>e.isGeneratingTokenByImageSource),b=Object(o.y)(a,g,(e,t)=>t[e]),O=Object(o.y)(s,e=>e.imageSourceTokensByImageSource)},ssbT:function(e,t,n){"use strict";var o=n("YMmn");n.d(t,"a",(function(){return o.a})),n("T2NM"),n("Ql0z");var c=n("nAcS");n.d(t,"b",(function(){return c.a})),n.d(t,"c",(function(){return c.c})),n.d(t,"d",(function(){return c.d})),n.d(t,"e",(function(){return c.e})),n.d(t,"f",(function(){return c.f})),n("YDRF")}}]);